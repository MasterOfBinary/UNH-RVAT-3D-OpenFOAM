#!/bin/sh
#cd ${0%/*} || exit 1    # run from this directory

# Source tutorial run functions
. $WM_PROJECT_DIR/bin/tools/RunFunctions

# Get the number of processors to run on from system/decomposeParDict
nProc=$(getNumberOfProcessors)

# Make dummy 0 directory
mkdir 0

runApplication blockMesh
runApplication surfaceFeatureExtract

runApplication decomposePar

runParallel snappyHexMesh $nProc -overwrite -dict system/snappyHexMeshDict.turbine

# force removal of fields generated by snappy
\rm -rf 0

# - apply the initial fields
cp -rf 0.org 0

# Reconstruct the mesh, but leave deconstructed as well
runApplication reconstructParMesh -constant

rm -rf processor*

runApplication checkMesh
runApplication yPlus

# - test by running moveDynamicMesh
#runApplication moveDynamicMesh -checkAMI
